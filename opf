    # Insert dependencies from parsed SQL
    col_op = "READ" if op_type not in ("INSERT", "UPDATE", "DELETE") else "WRITE"
    for dep in deps["tables"]:
        # Ensure the dependency is a tuple and has at least three elements.
        if not isinstance(dep, tuple) or len(dep) < 3:
            logger.error(f"Invalid dependency tuple encountered: {dep}")
            continue
        schema = dep[0] if len(dep) > 0 else None
        table = dep[1] if len(dep) > 1 else None
        alias = dep[2] if len(dep) > 2 else None
        is_sub = dep[3] if len(dep) > 3 else False
        if table and not table.startswith("(CTE)"):
            dbn = schema if schema else "dbo"
            try:
                c.execute("""
                    INSERT INTO BRM_RULE_TABLE_DEPENDENCIES(
                        RULE_ID, DATABASE_NAME, TABLE_NAME, COLUMN_NAME, COLUMN_OP
                    )
                    VALUES (?, ?, ?, ?, ?)
                """, (new_rule_id, dbn, table, "AutoCol", col_op))
            except Exception as ex:
                logger.error(f"Error inserting dependency {dep}: {ex}")
