    # Insert dependencies from parsed SQL (deps["tables"])
    col_op = "READ"
    if op_type in ("INSERT", "UPDATE", "DELETE"):
        col_op = "WRITE"
    for item in deps["tables"]:
        # Check tuple length; some items may contain only 3 elements.
        if len(item) == 4:
            schema, table, alias, is_sub = item
        elif len(item) == 3:
            schema, table, alias = item
            is_sub = False
        else:
            continue
        if table and not table.startswith("(CTE)"):
            dbn = schema if schema else "dbo"
            c.execute("""
                INSERT INTO BRM_RULE_TABLE_DEPENDENCIES(
                    RULE_ID, DATABASE_NAME, TABLE_NAME, COLUMN_NAME, COLUMN_OP
                )
                VALUES (?, ?, ?, ?, ?)
            """, (new_rule_id, dbn, table, "AutoCol", col_op))